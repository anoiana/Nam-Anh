theta = rnorm(1,theta0,sqrt(1/q))
theta
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
x = rnorm(n,theta, sqrt(1/q))
x = rnorm(n,theta, sqrt(1/q))
theta0 = d$Mean[1]; k = 1
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
theta0 = d$Mean[1]; k = 1
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
sqrt(1/q)
d
n = 200
theta0 = d$Mean[1]; k = 1
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
q
theta0 = d$Mean[1]; k = d$n[1]
k
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
sqrt(k/q)
theta = rnorm(1,theta0,sqrt(k/q))
theta
theta0
theta = rnorm(1,theta0,sqrt(k/q))
sqrt(k/q)
theta = rnorm(1,theta0,sqrt(k/q))
theta
x = rnorm(n,theta, sqrt(1/q))
x
sqrt(1/q)
sqrt(1/q)
theta
n = 200
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
n = 1000
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi()
n = 10000
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi()
n = 1000
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
n = 10000
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
n = 10000
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
n = 10000
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
n = 10000
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
n = 10000
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
n = 10000
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
n = 10000
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
n = 10000
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
n = 10000
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
n = 10000
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
n = 10000
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
n = 10000
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
n = 10000
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
tau = 1/d$SD[1]^2
s2 = mean((1/d$SD[2:3]^2-tau)^2)
beta = (-tau+sqrt(tau^2+4*s2))/2
nu = tau/beta+1
x = rgamma(5000, shape = nu, scale = beta)%>% sort()
plot(x,dgamma(x,shape = nu, scale = beta),
xlab = "",
col = "gray40", main = "", type = "l")
abline(v = (nu-1)*beta, col = "gray40")
abline(v =1/d$SD^2, col = "red", lty = 2)
n = seq(200,300, by = 10)
l<-
sapply(n, function(i){
p = lgamma((i+2*nu)/2)+ lgamma((2*nu-1)/2)-lgamma((i+2*nu-1)/2)-lgamma(nu)
2*qt(0.975,i+2*nu)*sqrt(2*beta/(i+2*nu)/(i+1/d$n[1]))*exp(p)
})
l
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
theta
theta0
sqrt(1/q)
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
rt(1000,2*a+n)
sqrt(alpha2)
n = 10000
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
alpha2
sqrt(alpha2)
theta_bar
theta_bar
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
n = 200
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
n = 200
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
n = 200
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
n = 200
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
n = 200
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
n = 200
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
n = 200
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
sapply(1:1000,function(i){
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
})
sapply(1:1000,function(i){
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
})%>% mean()
i = seq(100,1000, by = 5)
i
sapply(i, function(n){
sapply(1:1000,function(i){
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
})%>% mean()
})
# Simulation Size
S <- 1000
# Priors
SoC_Prior <- rbeta(S, 2, 3)
NI_Prior <- rbeta(S, 3, 1)
# Sample Size
N <- seq(20, 250, by = 10)
AL <- vector("numeric", length = length(N))
j <- 1
Length_95CI <- vector("numeric", length = S)
for(i in 1:S){
# Data
SoC_X <- rbinom(N[j], 1, SoC_Prior[i])
NI_X <- rbinom(N[j], 1, NI_Prior[i])
# Posterior
SoC_Posterior <- rbeta(S, 2 + sum(SoC_X), 3 + N[j] - sum(SoC_X))
NI_Posterior <- rbeta(S, 3 + sum(NI_X), 1 + N[j] - sum(NI_X))
# Posterior - Treatment Effect (Risk Difference)
TE_Posterior <- NI_Posterior - SoC_Posterior
# Length 95% CI
Length_95CI[i] <- diff(HDInterval::hdi(TE_Posterior))
}
AL[j] <- mean(Length_95CI)
AL
ALC<-
sapply(i, function(n){
sapply(1:1000,function(i){
theta0 = d$Mean[1]; k = 1/d$n[1]
q = rgamma(1,a,scale = b)
theta = rnorm(1,theta0,sqrt(k/q))
x = rnorm(n,theta, sqrt(1/q))
theta_bar = (sum(x)+(theta0/k))/(n+1+k)
alpha2 = (1/b+ theta0^2/k + sum(x^2) )/(n+1+k)
(rt(1000,2*a+n)*sqrt(alpha2)+theta_bar) %>% HDInterval::hdi() %>% diff()
})%>% mean()
})
ALC
tau = 1/d$SD[1]^2
s2 = mean((1/d$SD[2:3]^2-tau)^2)
beta = (-tau+sqrt(tau^2+4*s2))/2
nu = tau/beta+1
x = rgamma(5000, shape = nu, scale = beta)%>% sort()
plot(x,dgamma(x,shape = nu, scale = beta),
xlab = "",
col = "gray40", main = "", type = "l")
abline(v = (nu-1)*beta, col = "gray40")
abline(v =1/d$SD^2, col = "red", lty = 2)
n = seq(200,300, by = 10)
l<-
sapply(n, function(i){
p = lgamma((i+2*nu)/2)+ lgamma((2*nu-1)/2)-lgamma((i+2*nu-1)/2)-lgamma(nu)
2*qt(0.975,i+2*nu)*sqrt(2*beta/(i+2*nu)/(i+d$n[1]))*exp(p)
})
tibble("Sample size" = n, "ALC" = l)%>%
knitr::kable(caption = "sample size and average length criterion (analytical)")%>%
kableExtra::kable_styling(
bootstrap_options = c("striped", "hover"),
full_width = TRUE)%>%
kableExtra::scroll_box(width = "100%", height = "400px",
box_css = "align: center; ",
extra_css = "border: none; left: 200px; "
)
i = 200
p = lgamma((i+2*nu)/2)+ lgamma((2*nu-1)/2)-lgamma((i+2*nu-1)/2)-lgamma(nu)
p
lgamma((i+2*nu)/2)
i = 300
gamma((i+2*nu)/2)
lgamma((i+2*nu)/2)
p = lgamma((i+2*nu)/2)+ lgamma((2*nu-1)/2)-lgamma((i+2*nu-1)/2)-lgamma(nu)
p
lgamma((2*nu-1)/2)
lgamma((i+2*nu-1)/2)
p = lgamma((i+2*nu)/2)+ lgamma((2*nu-1)/2)-lgamma((i+2*nu-1)/2)-lgamma(nu)
p
exp(p)
2*qt(0.975,i+2*nu)*sqrt(2*beta/(i+2*nu)/(i+d$n[1]))*exp(p)
l<-
sapply(n, function(i){
p = lgamma((i+2*nu)/2)+ lgamma((2*nu-1)/2)-lgamma((i+2*nu-1)/2)-lgamma(nu)
2*qt(0.975,i+2*nu)*sqrt(2*beta/(i+2*nu)/(i+d$n[1]))*exp(p)
})
n01 = d$n[1]; n02 = d$n[3]
func = function(n){
2*qt(0.975,n+n+n01-n02+2*nu)*sqrt(4*beta*(n+n01)/(2*n+n01-n02+2*nu)/(n+n01)/(n+n01))*exp(
lgamma((2*n+n01-n02+2*nu)/2)+
lgamma((2*nu-1)/2)-
lgamma((2*n+n01-n02+2*nu-1)/2)-
lgamma(nu)
)
}
func = Vectorize(func)
n = seq(100,500, by = 10)
n1n2<-
tibble(n1 = n)%>%
mutate(ALC = func(n))%>%
mutate(n2 = n1+n01-n02, .before = "ALC")
n1n2%>%
kableExtra::kbl(caption = "Sample size of midazolam, placebo.")%>%
kableExtra::kable_styling(bootstrap_options = c("striped", "hover"), full_width = TRUE)%>%
kableExtra::scroll_box(width = "100%", height = "400px",
box_css = "align: center; ",
extra_css = "border: none; left: 200px; "
)
n2 = pull(n1n2[4,2])
n03 = d$n[2]
func2 = function(n1){
p = lgamma((n1+n2+2*nu)/2)+lgamma((2*nu-1)/2)-lgamma((n1+n2+2*nu-1)/2)-lgamma(nu)
2*qt(0.975,n1+n2+2*nu)*sqrt(2*beta*(n1+n01+n2+n02)/(n1+n2+2*nu)/(n1+n01)/(n2+n02))*exp(p)
}
n2n3<-
map2_dfr(n1n2$n1,n1n2$n2,~{
tibble(n1 = .x, n2 = .y, n3 = c(.x,.x+3,.y))%>%
mutate(ALC = func2(n3))
})%>%
arrange(desc(ALC))
n2n3%>%
kableExtra::kbl(caption =  paste0("Sample size of lidocaine when sample size of placebo is ",n2,"."))%>%
kableExtra::kable_styling(bootstrap_options = c("striped", "hover"), full_width = TRUE)%>%
kableExtra::scroll_box(width = "100%", height = "400px",
box_css = "align: center; ",
extra_css = "border: none; left: 200px; "
)
?rnorm
q = rgamma(1,1)
a<-b<-1
q = rgamma(1,1)
theta0 = 2
q = rgamma(1,1)
theta = rnorm(1,2,sqrt(1/q))
theta
a<-b<-1
theta0 = 2
q = rgamma(1,1)
theta = rnorm(1,2,sqrt(1/q))
x = rnorm(1000,theta, sqrt(1/q))
n = 1000
theta_bar = (sum(x)+theta0)/(n+1)
theta = rnorm(theta_bar,1/q/(n+1))
theta = rnorm(n, theta_bar,sqrt(1/q/(n+1)) )
theta
theta
a<-b<-1
theta0 = 2
n = 1000
q = rgamma(1,1)
theta = rnorm(1,2,sqrt(1/q))
x = rnorm(1000,theta, sqrt(1/q))
theta_bar = (sum(x)+theta0)/(n+1)
theta_pos = rnorm(n, theta_bar,sqrt(1/q/(n+1)) )
hist(theta_pos)
alpha2 = (1/b + theta0^2 + sum(x^2))/(n+1+1)
a<-b<-1
theta0 = 2
n = 1000
q = rgamma(1,1)
theta = rnorm(1,2,sqrt(1/q))
x = rnorm(1000,theta, sqrt(1/q))
theta_bar = (sum(x)+theta0)/(n+1)
alpha2 = (1/b + theta0^2 + sum(x^2))/(n+1+1)
rt(1000,2*a+n)*sqrt(alpha2) + theta_bar
k = rt(1000,2*a+n)*sqrt(alpha2) + theta_bar
hist(k)
k = rt(1000,2*a+n)*sqrt(alpha2) + theta_bar
hist(k)
mean(k)
theta_bar
z =
sapply(1:1000,.%>%{
q = rgamma(1,1)
theta = rnorm(1,2,sqrt(1/q))
x = rnorm(1000,theta, sqrt(1/q))
theta_bar = (sum(x)+theta0)/(n+1)
alpha2 = (1/b + theta0^2 + sum(x^2))/(n+1+1)
#theta_pos = rnorm(n, theta_bar,sqrt(1/q/(n+1)) )
k = rt(1000,2*a+n)*sqrt(alpha2) + theta_bar
mean(k)
})
z
mean(z)
n
v3 = 1
v2 = n-1
v3 = 1
beta = 2
sigma2 = 1
pr = 1/2/beta*sigma2
u2 = rchisq(1000,v2); u3 = rchisq(1000,v3)
v2 = n-1
v3 = 1
beta = 2
sigma2 = 1
pr = 1/2/beta*sigma2
u2 = rchisq(1000,v2); u3 = rchisq(1000,v3)
u2 = rchisq(1000,v2); u3 = rchisq(1000,v3)
u2
v2 = n-1
v3 = 1
beta = 2
sigma2 = 1
pr = 1/2/beta*sigma2
u2
ù
u2
