{
  "articles": [
    {
      "path": "010301.html",
      "title": "Bayesian Sample Size Determination",
      "author": [
        {
          "name": "Nam Anh",
          "url": {}
        }
      ],
      "date": "Nov. 20, 2021",
      "contents": "\n\nContents\nBayesian criteria for sample size\nDetermine size of one binomial sample\nDetermine size of normal distribution\nSingle normal mean\n\n\nBayesian criteria for sample size\nLet \\(\\boldsymbol{\\mathfrak{X}} \\ni \\boldsymbol{x} = (x_1,\\dots,x_n)^{\\top}\\) and \\(\\boldsymbol{\\theta} \\in \\boldsymbol{\\Theta}\\) are a random sample with the size of \\(n\\) and parameter of interest, respectively. The predictive distribution of \\(\\{x_i\\}_{i=1}^n\\), i.e. pre-posterior distribution, is capable of obtaining from likelihood function as follows\n\\[\nf(x_i) = \\int_{\\boldsymbol{\\Theta}} f(x|\\boldsymbol{\\theta})d\\boldsymbol{\\theta},\n\\tag{1}\n\\] and the posterior distribution can be obtained\n\\[\nf(\\boldsymbol{\\theta}|x) = \\frac{f(x|\\boldsymbol{\\theta})f(\\boldsymbol{\\theta})}{f(x)},\n\\tag{2}\n\\]\n(2) also means\n\\[\nf(\\boldsymbol{\\theta}|x) \\propto f(x|\\boldsymbol{\\theta})f(\\boldsymbol{\\theta}).\n\\]\nThe posterior coverage probability of region R with volume of V is given by\n\\[\n\\int_{R}f(\\boldsymbol{\\theta}|x)d\\boldsymbol{\\theta},\n\\]\nR is HPD iff \\(f(\\boldsymbol{\\theta}_1|x) \\ge f(\\boldsymbol{\\theta}_2|x), \\forall \\boldsymbol{\\theta}_1 \\in R, \\boldsymbol{\\theta}_2 \\notin R\\). We now consider \\(\\boldsymbol{\\Theta}\\) is one-dimensional space, namely \\(\\boldsymbol{\\theta}\\) can be written as \\(\\theta\\). For the case of monotone increasing posterior densities defined on \\((u,v)\\), the corresponding condition for HPD is modified, see [1] for further detail.\nThree criteria considered in [1] are average coverage, average length and worst outcome, but we shall consider the average length criterion (ALC) in this review. Such a criterion is given by\n\\[\n\\int_{a(x,n)}^{a(x,n)+l'(x,n)}f(\\theta|x)d\\theta = 1-\\alpha,\n\\tag{3}\n\\]\nhere we fix the coverage probability \\(1-\\alpha\\) of HPD credible set for \\(\\theta\\). Each \\(x\\) will need a certain \\(l'(x,n)\\) to reach the desired coverage probability. We then calculate the expectation of \\(l'(x,n)\\) w.r.t predictive distribution \\(f(x)\\) and such a expectation is less than or equal a pre-specified length \\(l\\),\n\\[\n\\int_{\\mathfrak{X}}l'(x,n)f(x)dx \\le l,\n\\tag{4}\n\\]\nDetermine size of one binomial sample\nSuppose distribution of data \\(X\\) and prior distribution of \\(\\theta\\) are \\(X \\sim \\mathcal{Bin}(n,\\theta)\\) and \\(\\theta \\sim \\mathcal{Beta}(c,d)\\), respectively. Thus we can show that posterior distribution of \\(\\theta\\) is\n\\[\n\\theta|x,n,c,d \\sim \\mathcal{Beta}(c+x, d+n-x),\n\\tag{5}\n\\]\nand preposterior marginal distribution is\n\\[\np(x,n) = \\binom{n}{x}\\frac{B(c+x,d+n-x)}{B(c,d)},\n\\tag{6}\n\\]\nwhere \\(B(c,d) = \\frac{\\Gamma(c)\\Gamma(d)}{\\Gamma(c+d)}\\). We then calculate\n\\[\n\\int^{a(x,n)+l'(x,n)}_{a(x,n)}f(\\theta|,x,n,c,d)d\\theta = 1-\\alpha\n\\]\nand\n\\[\n\\sum^{n}_{x=0}l'(x,n)p(x,n) \\le l, \\quad \\textit{(l is prespecified)}\n\\]\n(cont.)\nDetermine size of normal distribution\nSingle normal mean\nSuppose we have a random vector \\(\\boldsymbol{X} = (X_1,X_2,\\dots,X_n)\\) that comprises exchangeable components following normal distribution with mean \\(\\mu\\) and precision \\(\\lambda = 1/\\sigma^2\\). prior distributions of \\(\\mu\\) and \\(\\lambda\\) are\n\\[\n\\lambda \\sim \\mathcal{Ga}(\\nu,\\beta),\n\\]\nand\n\\[\n\\mu|\\lambda \\sim \\mathcal{N}(\\mu_0, n_0\\lambda)\n\\]\nHere, we suppose both \\(\\mu\\) and \\(\\tau\\) are unknown, and marginal posterior distribution \\(\\mu|\\boldsymbol{x}\\) is\n\\[\n\\mu|\\boldsymbol{x} \\sim t_{2\\nu+n}\\sqrt{\\frac{\\beta_n}{(n+n_0)(\\nu+n/2)}}+\\mu_n,\n\\]\nwhere\n\\[\n\\mu_n = \\frac{n_0\\mu_0+n\\overline{x}}{n+n_0}\n\\]\nand\n\\[\n\\beta_n = \\beta+ \\frac{1}{2}ns^2+\\frac{1}{2}\\frac{nn_0}{n+n_0}(\\overline{x}-\\mu_0)^2, \\text{ where } ns^2 = \\sum_{i=1}^n(x_i-\\overline{x})^2\n\\] SSD w.r.t ALC criterion is obtained in [2] as \\(n\\) is sufficiently large such that\n\\[\nl \\ge 2 t_{n+2\\nu, 1-\\alpha/2}\\sqrt{\\frac{2\\beta}{(n+2\\nu)(n+n_0)}}\\frac{\\Gamma(\\frac{n+2\\nu}{2})\\Gamma(\\frac{2\\nu-1}{2})}{\\Gamma(\\frac{n+2\\nu-1}{2})\\Gamma(\\nu)}\n\\]\nWe shall now consider how to choose hyperparameters \\(\\nu\\) and \\(\\beta\\) for the precision \\(\\lambda\\). Suppose the aim is to obtain sample size of each treatment arm in a three-arm studies in which mean and standard deviation of outcome associated with each arm are known. This is,\n\n\nhide\n\nif(!library(pacman, logical.return = T)) install.packages(\"pacman\")\npacman::p_load(tidyverse, magrittr)\nd<-\ntibble(\n  Agent = c(\"midazolam\", \"lidocaine\", \"placebo\"),\n  Mean = c(3.2,4,4.8),\n  SE = c(2.9, 3.3,3.4),\n  n = c(57,52,50)\n)\nknitr::kable(d)\n\n\nAgent\nMean\nSE\nn\nmidazolam\n3.2\n2.9\n57\nlidocaine\n4.0\n3.3\n52\nplacebo\n4.8\n3.4\n50\n\n\n\n\n[1] Joseph L, Wolfson DB, Berger RD. Sample size calculations for binomial proportions via highest posterior density intervals. The Statistician 1995;44:143. https://doi.org/10.2307/2348439.\n\n\n[2] Joseph L, Bélisle P. Bayesian sample size determination for normal means and differences between normal means. Journal of the Royal Statistical Society Series D (The Statistician) 1997;46:209–26.\n\n\n\n\n",
      "last_modified": "2021-12-05T23:14:18-05:00"
    }
  ],
  "collections": []
}
